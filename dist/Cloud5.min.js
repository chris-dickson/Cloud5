!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;"undefined"!=typeof window?e=window:"undefined"!=typeof global?e=global:"undefined"!=typeof self&&(e=self),e.Cloud5=t()}}(function(){return function t(e,n,i){function o(s,h){if(!n[s]){if(!e[s]){var a="function"==typeof require&&require;if(!h&&a)return a(s,!0);if(r)return r(s,!0);throw new Error("Cannot find module '"+s+"'")}var l=n[s]={exports:{}};e[s][0].call(l.exports,function(t){var n=e[s][1][t];return o(n?n:t)},l,l.exports,t,e,n,i)}return n[s].exports}for(var r="function"==typeof require&&require,s=0;s<i.length;s++)o(i[s]);return o}({1:[function(t,e){var n=t("./util"),i=t("./textbitmap"),o=function(t){this._canvas=null,this._words=null,this._bitmap=null,this._renderInfo=null,this._textBitmapper=null,n.extend(this,t)};o.prototype=n.extend(o.prototype,{_initialize:function(){var t={width:this._canvas.width,height:this._canvas.height};this.debug&&(t.debug=!0),this._textBitmapper=new i(t),this._renderInfo={},this._bitmap=n.createArray(this._canvas.width,this._canvas.height);for(var e=0;e<this._canvas.width;e++)for(var o=0;o<this._canvas.height;o++)this._bitmap[e][o]=!1},_hit:function(t,e){var n=null,i=this,o=Object.keys(this._renderInfo).filter(function(n){var o=i._renderInfo[n],r=o.x+o.bb.offsetX,s=o.y+o.bb.offsetY,h=r+o.bb.width,a=s+o.bb.height;return t>=r&&h>=t&&e>=s&&a>=e?!0:!1});return o.sort(function(t,e){var n=i._renderInfo[t].bb,o=i._renderInfo[e].bb,r=n.width*n.height,s=o.width*o.height;return r-s}),o.length>0&&(n=o[0]),n},canvas:function(t){return t?(this._canvas=t,this):this._canvas},words:function(t){return t?(this._words=t,this):this._words},onWordOver:function(t){return this._onWordOver=t,this},onWordOut:function(t){return this._onWordOut=t,this},onWordClick:function(t){return this._onWordClick=t,this},layout:function(){function t(t,e,n){t.fillStyle="white",t.fillRect(0,0,e,n);var i=this;Object.keys(this._renderInfo).forEach(function(e){var n=i._renderInfo[e];void 0!==n.x&&-1!==n.x&&void 0!==n.y&&-1!==n.y&&(t.font=n.fontSize+"px "+n.fontFamily,t.fillStyle="red",t.strokeStyle="green",t.fillText(e,n.x,n.y),t.strokeRect(n.x+n.bb.offsetX,n.y+n.bb.offsetY,n.bb.width,n.bb.height))})}function e(t){var e=t.offsetX,n=t.offsetY,i=window.devicePixelRatio;e*=i,n*=i;var r=o._hit(e,n);r?(o._onWordOver&&o._onWordOver(r),d=r):d&&(o._onWordOut&&o._onWordOut(d),d=null)}function i(t){var e=t.offsetX,n=t.offsetY,i=window.devicePixelRatio;e*=i,n*=i;var r=o._hit(e,n);r&&o._onWordClick&&o._onWordClick(r)}if(this._initialize(),this._renderInfo={},this._words){var o=this,r=Number.MAX_VALUE,s=0;Object.keys(this._words).forEach(function(t){r=Math.min(o._words[t],r),s=Math.max(o._words[t],s)});var h=Object.keys(this._words).sort(function(t,e){return o._words[e]-o._words[t]});this.maxWords>0&&h.length>this.maxWords&&(h=h.splice(0,this.maxWords));var a=this.minFontSize||10,l=this.maxFontSize||200;h.forEach(function(t){var e=(o._words[t]-r)/(s-r),i=n.step(a,l,e),h=o._textBitmapper.create(t,i,o.font||"Calibri");o._renderInfo[t]=h,o._renderInfo[t].count=o._words[t],o._renderInfo[t].minCount=r,o._renderInfo[t].maxCount=s})}h.forEach(function(e){var n=!1,i=100;this.debug&&t(o._canvas.getContext("2d"),o._canvas.width,o._canvas.height);for(var r=o._renderInfo[e];!n&&i>0;){var s=Math.floor(Math.random()*o._canvas.width),h=Math.floor(Math.random()*o._canvas.height);if(r.x=s,r.y=h,o._textBitmapper.fits(r,o._bitmap)){n=!0;for(var a=r.bitmap.length,l=r.bitmap[0].length,d=0;a>d;d++)for(var u=0;l>u;u++){var f=r.x+r.bb.offsetX+d,c=r.y+r.bb.offsetY+u;r.bitmap[d][u]&&(o._bitmap[f][c]=e)}}else i--}n||(r.x=-1,r.y=-1)});var d=null;return this._canvas.onmousemove=e,this._canvas.onclick=i,o._renderInfo}}),e.exports=o},{"./textbitmap":5,"./util":6}],2:[function(t,e){var n=t("./util"),i=function(t){this.writeLog=t,this.logs=[]};i.prototype=n.extend(i.prototype,{push:function(t){this.writeLog&&this.logs.push({label:t,time:Date.now()})},pop:function(){if(this.writeLog){for(var t=this.logs.length,e=this.logs.pop(),n="",i=0;i<t.length;i++)n+="	";var o=Date.now(),r=o-e.time;n+=e.label+":"+r+"ms",console.log(n)}},_millisecondsToString:function(t){var e,n=36e5,i=6e4,o=1e3,r=0,s=0,h=0;return t>=n&&(h=Math.floor(t/n)),t=h>0?t-h*n:t,t>=i&&(s=Math.floor(t/i)),t=s>0?t-s*i:t,t>=o&&(r=Math.floor(t/o)),t=r>0?t-r*o:t,e=h>0?(h>9?h:"0"+h)+":":"00:",e+=s>0?(s>9?s:"0"+s)+":":"00:",e+=r>0?(r>9?r:"0"+r)+":":"00:",e+=t>0?t>9?t:"0"+t:"00"}}),e.exports=i},{"./util":6}],3:[function(t,e){var n=t("./util"),i=t("./layout"),o=t("./stopwords"),r=t("./logger"),s=!0,h=function(t){this._logger=new r(s),this._words={},this._stopWords={},this._canvas=null,this._width=null,this._height=null,this._backgroundFill=null,this._onWordOver=null,this._onWordOut=null,this._onWordClick=null,this._layout=null,n.extend(this,t)};h.prototype=n.extend(h.prototype,{canvas:function(t){if(t){var e=window.devicePixelRatio,n=t.width,i=t.height,o=n,r=i;return e>1&&(n*=e,i*=e),this._canvas=t,this._canvas.width=n,this._canvas.height=i,this._canvas.style.width=o+"px",this._canvas.style.height=r+"px;",this._width=n,this._height=i,this}return this._canvas},width:function(t){return t?(this.resize(t),this):this.width},height:function(t){return t?(this._canvas&&this.resize(void 0,t),this):this._height},resize:function(t,e){var n=window.devicePixelRatio;return t&&(this._canvas.width=n*t,this._canvas.style.width=t+"px",this._width=n*t),e&&(this._canvas.height=n*e,this._canvas.style.height=e+"px",this._height=n*e),this},text:function(t){var e=t.replace(/[\.,-\/#!$%\^&\*;:{}=\-_`~()]/g,"");this._filters&&this._filters.forEach(function(n){e=t.replace(n,"")});var n=e.split(" ");return this.words(n),this},textFilters:function(t){return t?(this._filters=t,this):this._filters},stop:function(t){if(t){var e=this;return t.forEach(function(t){e._stopWords[t.trim().toLowerCase()]=!0}),this}return this._stopWords},clear:function(){var t=this._canvas.getContext("2d");t.fillStyle=this._backgroundFill||"white",t.fillRect(0,0,this._width,this._height)},background:function(t){return t?(this._backgroundFill=t,this):this._backgroundFill},words:function(t){if(t){var e=this;return 0===Object.keys(this._stopWords).length&&this.stop(o.English),t.forEach(function(t){var n=t.trim().toLowerCase();if(!e._stopWords[n]&&""!==n){var i=e._words[n];i||(i=0),i++,e._words[n]=i}}),this}return this._words},onWordOver:function(t){return this._onWordOver=t,this},onWordOut:function(t){return this._onWordOut=t,this},onWordClick:function(t){return this._onWordClick=t,this},font:function(t){return t?(this._font=t,this):this._font},minFontSize:function(t){return t?(this._minFontSize=t,this):this._minFontSize},maxFontSize:function(t){return t?(this._maxFontSize=t,this):this._maxFontSize},maxWords:function(t){return void 0!==t?(this._maxWords=t,this):this._maxWords},color:function(t){return t?(this._color=t,this):this._color},generate:function(){var t={};this.debug&&(t.debug=!0),this._font&&(t.font=this._font),this._minFontSize&&(t.minFontSize=this._minFontSize),this._maxFontSize&&(t.maxFontSize=this._maxFontSize),void 0!==this._maxWords&&(t.maxWords=this._maxWords),this._logger.push("Layout"),this._layout=new i(t).canvas(this._canvas).words(this._words).onWordOver(this._onWordOver).onWordOut(this._onWordOut).onWordClick(this._onWordClick),this._logger.pop();var e=this._layout.layout();this.clear();var n=this._canvas.getContext("2d");this._logger.push("Render");var o=this;return Object.keys(e).forEach(function(t){var i=e[t];if(-1!==i.x&&-1!==i.y){n.font=i.fontSize+"px "+i.fontFamily;var r="black";if(o._color)if(o._color instanceof Array){var s=Math.floor(Math.random()*o._color.length);r=o._color[s]}else r=o._color instanceof Function?o._color(e[t]):o._color;n.fillStyle=r,n.fillText(t,i.x,i.y),o.debug&&(n.strokeStyle="green",n.strokeRect(i.x+i.bb.offsetX,i.y+i.bb.offsetY,i.bb.width,i.bb.height))}}),this._logger.pop(),this},save:function(t,e){var n=this._canvas.toDataURL(t||"image/png"),i=n.indexOf(",");n=n.substring(i);var o=document.createElement("a");o.href="data:application/octet-stream;base64"+n,e&&(o.download=e),o.click()}}),e.exports=h},{"./layout":1,"./logger":2,"./stopwords":4,"./util":6}],4:[function(t,e,n){var i="a, about, above, across, after, again, against, all, almost, alone, along, already, also, although, always, am, among, an, and, another, any, anybody, anyone, anything, anywhere, are, area, areas, aren't, around, as, ask, asked, asking, asks, at, away, b, back, backed, backing, backs, be, became, because, become, becomes, been, before, began, behind, being, beings, below, best, better, between, big, both, but, by, c, came, can, cannot, can't, case, cases, certain, certainly, clear, clearly, come, could, couldn't, d, did, didn't, differ, different, differently, do, does, doesn't, doing, done, don't, down, downed, downing, downs, during, e, each, early, either, end, ended, ending, ends, enough, even, evenly, ever, every, everybody, everyone, everything, everywhere, f, face, faces, fact, facts, far, felt, few, find, finds, first, for, four, from, full, fully, further, furthered, furthering, furthers, g, gave, general, generally, get, gets, give, given, gives, go, going, good, goods, got, great, greater, greatest, group, grouped, grouping, groups, h, had, hadn't, has, hasn't, have, haven't, having, he, he'd, he'll, her, here, here's, hers, herself, he's, high, higher, highest, him, himself, his, how, however, how's, i, i'd, if, i'll, i'm, important, in, interest, interested, interesting, interests, into, is, isn't, it, its, it's, itself, i've, j, just, k, keep, keeps, kind, knew, know, known, knows, l, large, largely, last, later, latest, least, less, let, lets, let's, like, likely, long, longer, longest, m, made, make, making, man, many, may, me, member, members, men, might, more, most, mostly, mr, mrs, much, must, mustn't, my, myself, n, necessary, need, needed, needing, needs, never, new, newer, newest, next, no, nobody, non, noone, nor, not, nothing, now, nowhere, number, numbers, o, of, off, often, old, older, oldest, on, once, one, only, open, opened, opening, opens, or, order, ordered, ordering, orders, other, others, ought, our, ours, ourselves, out, over, own, p, part, parted, parting, parts, per, perhaps, place, places, point, pointed, pointing, points, possible, present, presented, presenting, presents, problem, problems, put, puts, q, quite, r, rather, really, right, room, rooms, s, said, same, saw, say, says, second, seconds, see, seem, seemed, seeming, seems, sees, several, shall, shan't, she, she'd, she'll, she's, should, shouldn't, show, showed, showing, shows, side, sides, since, small, smaller, smallest, so, some, somebody, someone, something, somewhere, state, states, still, such, sure, t, take, taken, than, that, that's, the, their, theirs, them, themselves, then, there, therefore, there's, these, they, they'd, they'll, they're, they've, thing, things, think, thinks, this, those, though, thought, thoughts, three, through, thus, to, today, together, too, took, toward, turn, turned, turning, turns, two, u, under, until, up, upon, us, use, used, uses, v, very, w, want, wanted, wanting, wants, was, wasn't, way, ways, we, we'd, well, we'll, wells, went, were, we're, weren't, we've, what, what's, when, when's, where, where's, whether, which, while, who, whole, whom, who's, whose, why, why's, will, with, within, without, won't, work, worked, working, works, would, wouldn't, x, y, year, years, yes, yet, you, you'd, you'll, young, younger, youngest, your, you're, yours, yourself, yourselves, you've, z",o=i.split(",");n.English=o},{}],5:[function(t,e){var n=t("./util"),i=function(t){this._context=null,n.extend(this,t),this._canvas=document.createElement("canvas"),this._canvas.width=this.width||640,this._canvas.height=this.height||480,this._context=this._canvas.getContext("2d"),this.debug&&document.body.appendChild(this._canvas),this._bitmap=n.createArray(this._canvas.width,this._canvas.height);for(var e=0;e<this._canvas.width;e++)for(var i=0;i<this._canvas.height;i++)this._bitmap[e][i]=!1};i.prototype=n.extend(i.prototype,{create:function(t,e,i){var o=this._context;o.fillStyle="black",o.fillRect(0,0,this._canvas.width,this._canvas.height);var r=5,s=Math.floor(this._canvas.height/2);o.fillStyle="white",o.font=e+"px "+i,o.fillText(t,r,s);for(var h=o.measureText(t).width,a=r,l=s-e-2,d=a+h+r,u=l+e+.5*e,f=o.getImageData(a,l,d-a,u-l),c=n.createArray(f.width,f.height),g=0,_=0,v=0;v<f.data.length;v+=4)c[g][_]=0!==f.data[v],g++,g===f.width&&(g=0,_++);var w=Number.MAX_VALUE,m=Number.MAX_VALUE,p=-Number.MAX_VALUE,y=-Number.MAX_VALUE;for(g=0;g<c.length;g++)for(_=0;_<c[g].length;_++)c[g][_]&&(w=Math.min(w,g),m=Math.min(m,_),p=Math.max(p,g),y=Math.max(y,_));var b=n.createArray(p-w,y-m);for(g=0;p-w>g;g++)for(_=0;y-m>_;_++)b[g][_]=c[w+g][m+_];this.debug&&(o.strokeStyle="yellow",o.strokeRect(a,l,d-a,u-l)),o.strokeStyle="red",o.strokeRect(r,s,this._canvas.width,this._canvas.height);var x=p-w,k=y-m,W=-(r-(a+w)),S=-(s-(l+m));this.debug&&(o.strokeStyle="green",o.strokeRect(r+W,s+S,x,k));var O={bb:{offsetX:W,offsetY:S,width:x,height:k},bitmap:b,fontSize:e,fontFamily:i};return O},fits:function(t,e){for(var n=t.x+t.bb.offsetX,i=t.y+t.bb.offsetY,o=e.length,r=e[0].length,s=0>n||0>i,h=!1,a=s||h,l=0;l<t.bb.width&&!a;l++)for(var d=n+l,u=0;u<t.bb.height&&!a;u++){var f=i+u;d>=o||f>=r?s=!0:e[d][f]&&(h=!0),a=s||h}return!a}}),e.exports=i},{"./util":6}],6:[function(t,e){var n={extend:function(t){var e,n,i;for(n=1;n<arguments.length;n++){i=arguments[n];for(e in i)i.hasOwnProperty(e)&&(t[e]=i[e])}return t},lerp:function(t,e,n){return t+n*(e-t)},step:function(t,e,n){return Math.round(this.lerp(t,e,n))},createArray:function(t){var e=new Array(t||0),n=t;if(arguments.length>1)for(var i=Array.prototype.slice.call(arguments,1);n--;)e[t-1-n]=this.createArray.apply(this,i);return e}};e.exports=n},{}]},{},[3])(3)});