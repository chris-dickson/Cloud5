!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;"undefined"!=typeof window?e=window:"undefined"!=typeof global?e=global:"undefined"!=typeof self&&(e=self),e.Cloud5=t()}}(function(){return function t(e,i,n){function s(r,h){if(!i[r]){if(!e[r]){var a="function"==typeof require&&require;if(!h&&a)return a(r,!0);if(o)return o(r,!0);throw new Error("Cannot find module '"+r+"'")}var l=i[r]={exports:{}};e[r][0].call(l.exports,function(t){var i=e[r][1][t];return s(i?i:t)},l,l.exports,t,e,i,n)}return i[r].exports}for(var o="function"==typeof require&&require,r=0;r<n.length;r++)s(n[r]);return s}({1:[function(t,e){var i=t("./util"),n=t("./textbitmap"),s=function(t){this._canvas=null,this._words=null,this._bitmap=null,this._renderInfo=null,this._textBitmapper=null,i.extend(this,t)};s.prototype=i.extend(s.prototype,{_initialize:function(){var t={width:this._canvas.width,height:this._canvas.height};this.debug&&(t.debug=!0),this._textBitmapper=new n(t),this._renderInfo={},this._bitmap=i.createArray(this._canvas.width,this._canvas.height);for(var e=0;e<this._canvas.width;e++)for(var s=0;s<this._canvas.height;s++)this._bitmap[e][s]=!1},_hit:function(t,e){var i=null,n=this,s=Object.keys(this._renderInfo).filter(function(i){var s=n._renderInfo[i],o=s.x+s.bb.offsetX,r=s.y+s.bb.offsetY,h=o+s.bb.width,a=r+s.bb.height;return t>=o&&h>=t&&e>=r&&a>=e?!0:!1});return s.sort(function(t,e){var i=n._renderInfo[t].bb,s=n._renderInfo[e].bb,o=i.width*i.height,r=s.width*s.height;return o-r}),s.length>0&&(i=s[0]),i},canvas:function(t){return t?(this._canvas=t,this):this._canvas},words:function(t){return t?(this._words=t,this):this._words},layouter:function(t){return this._layouter=t,this},onWordOver:function(t){return this._onWordOver=t,this},onWordOut:function(t){return this._onWordOut=t,this},onWordClick:function(t){return this._onWordClick=t,this},place:function(t,e){for(var i=e.bitmap.length,n=e.bitmap[0].length,s=0;i>s;s++)for(var o=0;n>o;o++){var r=e.x+e.bb.offsetX+s,h=e.y+e.bb.offsetY+o;e.bitmap[s][o]&&(this._bitmap[r][h]=t)}},fits:function(t){return this._textBitmapper.fits(t,this._bitmap)},randomLayout:function(t,e,i,n){var s=this;t.forEach(function(t){var o=!1,r=100;this.debug&&s.debugDrawAll(s._canvas.getContext("2d"),i,n);for(var h=e[t];!o&&r>0;){var a=Math.floor(Math.random()*i),l=Math.floor(Math.random()*n);h.x=a,h.y=l,s.fits(h)?(o=!0,s.place(t,h)):r--}o||(h.x=-1,h.y=-1)})},debugDrawAll:function(t,e,i){t.fillStyle="white",t.fillRect(0,0,e,i);var n=this;Object.keys(this._renderInfo).forEach(function(e){var i=n._renderInfo[e];void 0!==i.x&&-1!==i.x&&void 0!==i.y&&-1!==i.y&&(t.font=i.fontSize+"px "+i.fontFamily,t.fillStyle="red",t.strokeStyle="green",t.fillText(e,i.x,i.y),t.strokeRect(i.x+i.bb.offsetX,i.y+i.bb.offsetY,i.bb.width,i.bb.height))})},layout:function(){function t(t){var e=t.offsetX,i=t.offsetY,s=window.devicePixelRatio;e*=s,i*=s;var o=n._hit(e,i);o?(l&&(n._onWordOut&&n._onWordOut(l),l=null),n._onWordOver&&n._onWordOver(o),l=o):(n._onWordOut&&n._onWordOut(l),l=null)}function e(t){var e=t.offsetX,i=t.offsetY,s=window.devicePixelRatio;e*=s,i*=s;var o=n._hit(e,i);o&&n._onWordClick&&n._onWordClick(o)}if(this._initialize(),this._renderInfo={},this._words){var n=this,s=Number.MAX_VALUE,o=0;Object.keys(this._words).forEach(function(t){s=Math.min(n._words[t],s),o=Math.max(n._words[t],o)});var r=Object.keys(this._words).sort(function(t,e){return n._words[e]-n._words[t]});this.maxWords>0&&r.length>this.maxWords&&(r=r.splice(0,this.maxWords));var h=this.minFontSize||10,a=this.maxFontSize||200;r.forEach(function(t){var e=(n._words[t]-s)/(o-s),r=i.step(h,a,e),l=n._textBitmapper.create(t,r,n.font||"Calibri");n._renderInfo[t]=l,n._renderInfo[t].count=n._words[t],n._renderInfo[t].minCount=s,n._renderInfo[t].maxCount=o})}this._layouter?this._layouter.call(this,r,n._renderInfo,this._canvas.width,this._canvas.height,this.fits,this.place):this.randomLayout(r,n._renderInfo,this._canvas.width,this._canvas.height);var l=null;return this._canvas.onmousemove=t,this._canvas.onclick=e,n._renderInfo}}),e.exports=s},{"./textbitmap":5,"./util":6}],2:[function(t,e){var i=t("./util"),n=function(t){this.writeLog=t,this.logs=[]};n.prototype=i.extend(n.prototype,{push:function(t){this.writeLog&&this.logs.push({label:t,time:Date.now()})},pop:function(){if(this.writeLog){for(var t=this.logs.length,e=this.logs.pop(),i="",n=0;n<t.length;n++)i+="	";var s=Date.now(),o=s-e.time;i+=e.label+":"+o+"ms",console.log(i)}},_millisecondsToString:function(t){var e,i=36e5,n=6e4,s=1e3,o=0,r=0,h=0;return t>=i&&(h=Math.floor(t/i)),t=h>0?t-h*i:t,t>=n&&(r=Math.floor(t/n)),t=r>0?t-r*n:t,t>=s&&(o=Math.floor(t/s)),t=o>0?t-o*s:t,e=h>0?(h>9?h:"0"+h)+":":"00:",e+=r>0?(r>9?r:"0"+r)+":":"00:",e+=o>0?(o>9?o:"0"+o)+":":"00:",e+=t>0?t>9?t:"0"+t:"00"}}),e.exports=n},{"./util":6}],3:[function(t,e){var i=t("./util"),n=t("./layout"),s=t("./stopwords"),o=t("./logger"),r=!0,h=function(t){this._logger=new o(r),this._words={},this._stopWords={},this._canvas=null,this._highlightCanvas=null,this._highlightedWords=null,this._width=null,this._height=null,this._backgroundFill=null,this._onWordOver=null,this._onWordOut=null,this._onWordClick=null,this._layout=null,this._renderInfo=null,i.extend(this,t)};h.prototype=i.extend(h.prototype,{canvas:function(t){if(t){if(t===this._canvas)return this;var e=window.devicePixelRatio,i=t.width,n=t.height,s=i,o=n;return e>1&&(i*=e,n*=e),this._highlightedWords={},this._renderInfo={},this._canvas=t,this._canvas.width=i,this._canvas.height=n,this._canvas.style.width=s+"px",this._canvas.style.height=o+"px;",this._width=i,this._height=n,this._highlightCanvas=document.createElement("canvas"),this._highlightCanvas.width=this._canvas.width,this._highlightCanvas.height=this._canvas.height,this._highlightCanvas.style.width=this._canvas.style.width,this._highlightCanvas.style.height=this._canvas.style.height,this._highlightCanvas.style.position="absolute",this._highlightCanvas.style.pointerEvents="none",this._highlightCanvas.style.top=this._canvas.getBoundingClientRect().top,this._highlightCanvas.style.left=this._canvas.getBoundingClientRect().left,this._canvas.parentNode.insertBefore(this._highlightCanvas,this._canvas),this}return this._canvas},width:function(t){return t?(this.resize(t),this):this.width},height:function(t){return t?(this._canvas&&this.resize(void 0,t),this):this._height},resize:function(t,e){var i=window.devicePixelRatio;return t&&(this._canvas.width=i*t,this._canvas.style.width=t+"px",this._width=i*t,this._highlightCanvas&&(this._highlightCanvas.width=this._canvas.width,this._highlightCanvas.style.width=this._canvas.style.width)),e&&(this._canvas.height=i*e,this._canvas.style.height=e+"px",this._height=i*e,this._highlightCanvas&&(this._highlightCanvas.height=this._canvas.height,this._highlightCanvas.style.height=this._canvas.style.height)),this},text:function(t){var e=t.replace(/[\.,-\/#!$%\^&\*;:{}=\-_`~()]/g,"");this._filters&&this._filters.forEach(function(i){e=t.replace(i,"")});var i=e.split(" ");return this.words(i),this},textFilters:function(t){return t?(this._filters=t,this):this._filters},stop:function(t){if(t){var e=this;return t.forEach(function(t){e._stopWords[t.trim().toLowerCase()]=!0}),this}return this._stopWords},clear:function(){var t=this._canvas.getContext("2d");t.fillStyle=this._backgroundFill||"white",t.fillRect(0,0,this._width,this._height)},background:function(t){return t?(this._backgroundFill=t,this):this._backgroundFill},words:function(t){if(t){var e=this;return 0===Object.keys(this._stopWords).length&&this.stop(s.English),t.forEach(function(t){var i=t.trim().toLowerCase();if(!e._stopWords[i]&&""!==i){var n=e._words[i];n||(n=0),n++,e._words[i]=n}}),this}return this._words},highlight:function(t,e){t instanceof Array==!1&&(t=[t]);var i=this;t.forEach(function(t){i._highlightedWords[t]=e}),this._updateHightlight()},unhighlight:function(t){t instanceof Array==!1&&(t=[t]);var e=this;t.forEach(function(t){delete e._highlightedWords[t]}),this._updateHightlight()},_updateHightlight:function(){var t=this,e=this._highlightCanvas.getContext("2d");e.clearRect(0,0,this._highlightCanvas.width,this._highlightCanvas.height),Object.keys(this._highlightedWords).forEach(function(i){var n=t._renderInfo[i],s=t._highlightedWords[i];n&&(e.fillStyle=s,e.font=n.fontSize+"px "+n.fontFamily,e.fillText(i,n.x,n.y))})},onWordOver:function(t){return this._onWordOver=t,this},onWordOut:function(t){return this._onWordOut=t,this},onWordClick:function(t){return this._onWordClick=t,this},font:function(t){return t?(this._font=t,this):this._font},minFontSize:function(t){return t?(this._minFontSize=t,this):this._minFontSize},maxFontSize:function(t){return t?(this._maxFontSize=t,this):this._maxFontSize},maxWords:function(t){return void 0!==t?(this._maxWords=t,this):this._maxWords},color:function(t){return t?(this._color=t,this):this._color},layout:function(t){return this._layout=t,this},generate:function(){var t={};this.debug&&(t.debug=!0),this._font&&(t.font=this._font),this._minFontSize&&(t.minFontSize=this._minFontSize),this._maxFontSize&&(t.maxFontSize=this._maxFontSize),void 0!==this._maxWords&&(t.maxWords=this._maxWords),this._logger.push("Layout"),this._layout=new n(t).canvas(this._canvas).words(this._words).layouter(this._layout).onWordOver(this._onWordOver).onWordOut(this._onWordOut).onWordClick(this._onWordClick),this._logger.pop(),this._renderInfo=this._layout.layout(),this.clear();var e=this._canvas.getContext("2d");this._logger.push("Render");var i=this;return Object.keys(this._renderInfo).forEach(function(t){var n=i._renderInfo[t];if(-1!==n.x&&-1!==n.y){e.font=n.fontSize+"px "+n.fontFamily;var s="black";if(i._color)if(i._color instanceof Array){var o=Math.floor(Math.random()*i._color.length);s=i._color[o]}else s=i._color instanceof Function?i._color(n):i._color;e.fillStyle=s,e.fillText(t,n.x,n.y),i.debug&&(e.strokeStyle="green",e.strokeRect(n.x+n.bb.offsetX,n.y+n.bb.offsetY,n.bb.width,n.bb.height))}}),this._logger.pop(),this},save:function(t,e){var i=this._canvas.toDataURL(t||"image/png"),n=i.indexOf(",");i=i.substring(n);var s=document.createElement("a");s.href="data:application/octet-stream;base64"+i,e&&(s.download=e),s.click()}}),e.exports=h,e.exports.Stopwords=s},{"./layout":1,"./logger":2,"./stopwords":4,"./util":6}],4:[function(t,e,i){var n="a, about, above, across, after, again, against, all, almost, alone, along, already, also, although, always, am, among, an, and, another, any, anybody, anyone, anything, anywhere, are, area, areas, aren't, around, as, ask, asked, asking, asks, at, away, b, back, backed, backing, backs, be, became, because, become, becomes, been, before, began, behind, being, beings, below, best, better, between, big, both, but, by, c, came, can, cannot, can't, case, cases, certain, certainly, clear, clearly, come, could, couldn't, d, did, didn't, differ, different, differently, do, does, doesn't, doing, done, don't, down, downed, downing, downs, during, e, each, early, either, end, ended, ending, ends, enough, even, evenly, ever, every, everybody, everyone, everything, everywhere, f, face, faces, fact, facts, far, felt, few, find, finds, first, for, four, from, full, fully, further, furthered, furthering, furthers, g, gave, general, generally, get, gets, give, given, gives, go, going, good, goods, got, great, greater, greatest, group, grouped, grouping, groups, h, had, hadn't, has, hasn't, have, haven't, having, he, he'd, he'll, her, here, here's, hers, herself, he's, high, higher, highest, him, himself, his, how, however, how's, i, i'd, if, i'll, i'm, important, in, interest, interested, interesting, interests, into, is, isn't, it, its, it's, itself, i've, j, just, k, keep, keeps, kind, knew, know, known, knows, l, large, largely, last, later, latest, least, less, let, lets, let's, like, likely, long, longer, longest, m, made, make, making, man, many, may, me, member, members, men, might, more, most, mostly, mr, mrs, much, must, mustn't, my, myself, n, necessary, need, needed, needing, needs, never, new, newer, newest, next, no, nobody, non, noone, nor, not, nothing, now, nowhere, number, numbers, o, of, off, often, old, older, oldest, on, once, one, only, open, opened, opening, opens, or, order, ordered, ordering, orders, other, others, ought, our, ours, ourselves, out, over, own, p, part, parted, parting, parts, per, perhaps, place, places, point, pointed, pointing, points, possible, present, presented, presenting, presents, problem, problems, put, puts, q, quite, r, rather, really, right, room, rooms, s, said, same, saw, say, says, second, seconds, see, seem, seemed, seeming, seems, sees, several, shall, shan't, she, she'd, she'll, she's, should, shouldn't, show, showed, showing, shows, side, sides, since, small, smaller, smallest, so, some, somebody, someone, something, somewhere, state, states, still, such, sure, t, take, taken, than, that, that's, the, their, theirs, them, themselves, then, there, therefore, there's, these, they, they'd, they'll, they're, they've, thing, things, think, thinks, this, those, though, thought, thoughts, three, through, thus, to, today, together, too, took, toward, turn, turned, turning, turns, two, u, under, until, up, upon, us, use, used, uses, v, very, w, want, wanted, wanting, wants, was, wasn't, way, ways, we, we'd, well, we'll, wells, went, were, we're, weren't, we've, what, what's, when, when's, where, where's, whether, which, while, who, whole, whom, who's, whose, why, why's, will, with, within, without, won't, work, worked, working, works, would, wouldn't, x, y, year, years, yes, yet, you, you'd, you'll, young, younger, youngest, your, you're, yours, yourself, yourselves, you've, z",s=n.split(",");i.English=s},{}],5:[function(t,e){var i=t("./util"),n=function(t){this._context=null,i.extend(this,t),this._canvas=document.createElement("canvas"),this._canvas.width=this.width||640,this._canvas.height=this.height||480,this._context=this._canvas.getContext("2d"),this.debug&&document.body.appendChild(this._canvas),this._bitmap=i.createArray(this._canvas.width,this._canvas.height);for(var e=0;e<this._canvas.width;e++)for(var n=0;n<this._canvas.height;n++)this._bitmap[e][n]=!1};n.prototype=i.extend(n.prototype,{create:function(t,e,n){var s=this._context;s.fillStyle="black",s.fillRect(0,0,this._canvas.width,this._canvas.height);var o=5,r=Math.floor(this._canvas.height/2);s.fillStyle="white",s.font=e+"px "+n,s.fillText(t,o,r);for(var h=s.measureText(t).width,a=o,l=r-e-2,d=a+h+o,u=l+e+.5*e,f=s.getImageData(a,l,d-a,u-l),c=i.createArray(f.width,f.height),g=0,_=0,v=0;v<f.data.length;v+=4)c[g][_]=0!==f.data[v],g++,g===f.width&&(g=0,_++);var w=Number.MAX_VALUE,y=Number.MAX_VALUE,p=-Number.MAX_VALUE,m=-Number.MAX_VALUE;for(g=0;g<c.length;g++)for(_=0;_<c[g].length;_++)c[g][_]&&(w=Math.min(w,g),y=Math.min(y,_),p=Math.max(p,g),m=Math.max(m,_));var b=i.createArray(p-w,m-y);for(g=0;p-w>g;g++)for(_=0;m-y>_;_++)b[g][_]=c[w+g][y+_];this.debug&&(s.strokeStyle="yellow",s.strokeRect(a,l,d-a,u-l)),s.strokeStyle="red",s.strokeRect(o,r,this._canvas.width,this._canvas.height);var x=p-w,k=m-y,W=-(o-(a+w)),C=-(r-(l+y));this.debug&&(s.strokeStyle="green",s.strokeRect(o+W,r+C,x,k));var S={bb:{offsetX:W,offsetY:C,width:x,height:k},bitmap:b,fontSize:e,fontFamily:n};return S},fits:function(t,e){for(var i=t.x+t.bb.offsetX,n=t.y+t.bb.offsetY,s=e.length,o=e[0].length,r=0>i||0>n,h=!1,a=r||h,l=0;l<t.bb.width&&!a;l++)for(var d=i+l,u=0;u<t.bb.height&&!a;u++){var f=n+u;d>=s||f>=o?r=!0:e[d][f]&&(h=!0),a=r||h}return!a}}),e.exports=n},{"./util":6}],6:[function(t,e){var i={extend:function(t){var e,i,n;for(i=1;i<arguments.length;i++){n=arguments[i];for(e in n)n.hasOwnProperty(e)&&(t[e]=n[e])}return t},lerp:function(t,e,i){return t+i*(e-t)},step:function(t,e,i){return Math.round(this.lerp(t,e,i))},createArray:function(t){var e=new Array(t||0),i=t;if(arguments.length>1)for(var n=Array.prototype.slice.call(arguments,1);i--;)e[t-1-i]=this.createArray.apply(this,n);return e}};e.exports=i},{}]},{},[3])(3)});