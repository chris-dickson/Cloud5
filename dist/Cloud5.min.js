!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;"undefined"!=typeof window?e=window:"undefined"!=typeof global?e=global:"undefined"!=typeof self&&(e=self),e.Cloud5=t()}}(function(){return function t(e,n,o){function i(s,a){if(!n[s]){if(!e[s]){var h="function"==typeof require&&require;if(!a&&h)return h(s,!0);if(r)return r(s,!0);throw new Error("Cannot find module '"+s+"'")}var l=n[s]={exports:{}};e[s][0].call(l.exports,function(t){var n=e[s][1][t];return i(n?n:t)},l,l.exports,t,e,n,o)}return n[s].exports}for(var r="function"==typeof require&&require,s=0;s<o.length;s++)i(o[s]);return i}({1:[function(t,e){var n=t("./util"),o=t("./textbitmap"),i=function(t){this._canvas=null,this._words=null,this._bitmap=null,this._textBitmapper=null,n.extend(this,t)};i.prototype=n.extend(i.prototype,{_initialize:function(){var t={width:this._canvas.width,height:this._canvas.height};this.debug&&(t.debug=!0),this._textBitmapper=new o(t),this._bitmap=n.createArray(this._canvas.width,this._canvas.height);for(var e=0;e<this._canvas.width;e++)for(var i=0;i<this._canvas.height;i++)this._bitmap[e][i]=!1},canvas:function(t){return t?(this._canvas=t,this):this._canvas},words:function(t){return t?(this._words=t,this):this._words},onWordOver:function(t){return this._onWordOver=t,this},onWordOut:function(t){return this._onWordOut=t,this},layout:function(){function t(t,e,n){t.fillStyle="white",t.fillRect(0,0,e,n),Object.keys(o).forEach(function(e){var n=o[e];void 0!==n.x&&-1!==n.x&&void 0!==n.y&&-1!==n.y&&(t.font=n.fontSize+"px "+n.fontFamily,t.fillStyle="red",t.strokeStyle="green",t.fillText(e,n.x,n.y),t.strokeRect(n.x+n.bb.offsetX,n.y+n.bb.offsetY,n.bb.width,n.bb.height))})}function e(t){var e=t.offsetX,n=t.offsetY,o=i._bitmap[e][n];o?(i._onWordOver&&i._onWordOver(o),u=o):u&&(i._onWordOut&&i._onWordOut(u),u=null)}this._initialize();var o={};if(this._words){var i=this,r=Number.MAX_VALUE,s=0;Object.keys(this._words).forEach(function(t){r=Math.min(i._words[t],r),s=Math.max(i._words[t],s)});var a=this.minFontSize||10,h=this.maxFontSize||200;Object.keys(this._words).forEach(function(t){var e=(i._words[t]-r)/(s-r),l=n.step(a,h,e),u=i._textBitmapper.create(t,l,i.font||"Calibri");o[t]=u,o[t].count=i._words[t],o[t].minCount=r,o[t].maxCount=s})}var l=Object.keys(this._words).sort(function(t,e){return i._words[e]-i._words[t]});l.forEach(function(e){var n=!1,r=100;for(this.debug&&t(i._canvas.getContext("2d"),i._canvas.width,i._canvas.height);!n&&r>0;){var s=Math.floor(Math.random()*i._canvas.width),a=Math.floor(Math.random()*i._canvas.height);if(o[e].x=s,o[e].y=a,i._textBitmapper.fits(o[e],i._bitmap)){n=!0;for(var h=o[e].bitmap.length,l=o[e].bitmap[0].length,u=0;h>u;u++)for(var d=0;l>d;d++){var f=o[e].x+o[e].bb.offsetX+u,c=o[e].y+o[e].bb.offsetY+d;o[e].bitmap[u][d]&&(i._bitmap[f][c]=e)}}else r--}n||(o[e].x=-1,o[e].y=-1)});var u=null;return this._canvas.onmousemove=e,o}}),e.exports=i},{"./textbitmap":4,"./util":5}],2:[function(t,e){var n=t("./util"),o=t("./layout"),i=t("./stopwords"),r=function(t){this._words={},this._stopWords={},this._canvas=null,this._width=null,this._height=null,this._backgroundFill=null,this._onWordOver=null,this._layout=null,n.extend(this,t)};r.prototype=n.extend(r.prototype,{canvas:function(t){return t?(this._canvas=t,this._width=t.width,this._height=t.height,this):this._canvas},width:function(t){return t?(this._canvas&&(this._canvas.width=t,this._width=t),this):this.width},height:function(t){return t?(this._canvas&&(this._canvas.height=t,this._height=t),this):this._height},text:function(t){var e=t.replace(/[\.,-\/#!$%\^&\*;:{}=\-_`~()]/g,"");this._filters&&this._filters.forEach(function(n){e=t.replace(n,"")});var n=e.split(" ");return this.words(n),this},textFilters:function(t){return t?(this._filters=t,this):this._filters},stop:function(t){if(t){var e=this;return t.forEach(function(t){e._stopWords[t.trim().toLowerCase()]=!0}),this}return this._stopWords},background:function(t){return t?(this._backgroundFill=t,this):this._backgroundFill},words:function(t){if(t){var e=this;return 0===Object.keys(this._stopWords).length&&this.stop(i.English),t.forEach(function(t){var n=t.trim().toLowerCase();if(!e._stopWords[n]&&""!==n){var o=e._words[n];o||(o=0),o++,e._words[n]=o}}),this}return this._words},onWordOver:function(t){return this._onWordOver=t,this},onWordOut:function(t){return this._onWordOut=t,this},font:function(t){return t?(this._font=t,this):this._font},minFontSize:function(t){return t?(this._minFontSize=t,this):this._minFontSize},maxFontSize:function(t){return t?(this._maxFontSize=t,this):this._maxFontSize},color:function(t){return t?(this._color=t,this):this._color},generate:function(){var t={};this.debug&&(t.debug=!0),this._font&&(t.font=this._font),this._minFontSize&&(t.minFontSize=this._minFontSize),this._maxFontSize&&(t.maxFontSize=this._maxFontSize),this._layout=new o(t).canvas(this._canvas).words(this._words).onWordOver(this._onWordOver).onWordOut(this._onWordOut);var e=this._layout.layout(),n=this._canvas.getContext("2d");n.fillStyle=this._backgroundFill||"white",n.fillRect(0,0,this._width,this._height);var i=this;return Object.keys(e).forEach(function(t){var o=e[t];if(-1!==o.x&&-1!==o.y){n.font=o.fontSize+"px "+o.fontFamily;var r="black";if(i._color)if(i._color instanceof Array){var s=Math.floor(Math.random()*i._color.length);r=i._color[s]}else r=i._color instanceof Function?i._color(e[t]):i._color;n.fillStyle=r,n.fillText(t,o.x,o.y),i.debug&&(n.strokeStyle="green",n.strokeRect(o.x+o.bb.offsetX,o.y+o.bb.offsetY,o.bb.width,o.bb.height))}}),this}}),e.exports=r},{"./layout":1,"./stopwords":3,"./util":5}],3:[function(t,e,n){var o="a, about, above, across, after, again, against, all, almost, alone, along, already, also, although, always, am, among, an, and, another, any, anybody, anyone, anything, anywhere, are, area, areas, aren't, around, as, ask, asked, asking, asks, at, away, b, back, backed, backing, backs, be, became, because, become, becomes, been, before, began, behind, being, beings, below, best, better, between, big, both, but, by, c, came, can, cannot, can't, case, cases, certain, certainly, clear, clearly, come, could, couldn't, d, did, didn't, differ, different, differently, do, does, doesn't, doing, done, don't, down, downed, downing, downs, during, e, each, early, either, end, ended, ending, ends, enough, even, evenly, ever, every, everybody, everyone, everything, everywhere, f, face, faces, fact, facts, far, felt, few, find, finds, first, for, four, from, full, fully, further, furthered, furthering, furthers, g, gave, general, generally, get, gets, give, given, gives, go, going, good, goods, got, great, greater, greatest, group, grouped, grouping, groups, h, had, hadn't, has, hasn't, have, haven't, having, he, he'd, he'll, her, here, here's, hers, herself, he's, high, higher, highest, him, himself, his, how, however, how's, i, i'd, if, i'll, i'm, important, in, interest, interested, interesting, interests, into, is, isn't, it, its, it's, itself, i've, j, just, k, keep, keeps, kind, knew, know, known, knows, l, large, largely, last, later, latest, least, less, let, lets, let's, like, likely, long, longer, longest, m, made, make, making, man, many, may, me, member, members, men, might, more, most, mostly, mr, mrs, much, must, mustn't, my, myself, n, necessary, need, needed, needing, needs, never, new, newer, newest, next, no, nobody, non, noone, nor, not, nothing, now, nowhere, number, numbers, o, of, off, often, old, older, oldest, on, once, one, only, open, opened, opening, opens, or, order, ordered, ordering, orders, other, others, ought, our, ours, ourselves, out, over, own, p, part, parted, parting, parts, per, perhaps, place, places, point, pointed, pointing, points, possible, present, presented, presenting, presents, problem, problems, put, puts, q, quite, r, rather, really, right, room, rooms, s, said, same, saw, say, says, second, seconds, see, seem, seemed, seeming, seems, sees, several, shall, shan't, she, she'd, she'll, she's, should, shouldn't, show, showed, showing, shows, side, sides, since, small, smaller, smallest, so, some, somebody, someone, something, somewhere, state, states, still, such, sure, t, take, taken, than, that, that's, the, their, theirs, them, themselves, then, there, therefore, there's, these, they, they'd, they'll, they're, they've, thing, things, think, thinks, this, those, though, thought, thoughts, three, through, thus, to, today, together, too, took, toward, turn, turned, turning, turns, two, u, under, until, up, upon, us, use, used, uses, v, very, w, want, wanted, wanting, wants, was, wasn't, way, ways, we, we'd, well, we'll, wells, went, were, we're, weren't, we've, what, what's, when, when's, where, where's, whether, which, while, who, whole, whom, who's, whose, why, why's, will, with, within, without, won't, work, worked, working, works, would, wouldn't, x, y, year, years, yes, yet, you, you'd, you'll, young, younger, youngest, your, you're, yours, yourself, yourselves, you've, z",i=o.split(",");n.English=i},{}],4:[function(t,e){var n=t("./util"),o=function(t){this._context=null,n.extend(this,t),this._canvas=document.createElement("canvas"),this._canvas.width=this.width||640,this._canvas.height=this.height||480,this._context=this._canvas.getContext("2d"),this.debug&&document.body.appendChild(this._canvas),this._bitmap=n.createArray(this._canvas.width,this._canvas.height);for(var e=0;e<this._canvas.width;e++)for(var o=0;o<this._canvas.height;o++)this._bitmap[e][o]=!1};o.prototype=n.extend(o.prototype,{create:function(t,e,o){var i=this._context;i.fillStyle="black",i.fillRect(0,0,this._canvas.width,this._canvas.height);var r=5,s=Math.floor(this._canvas.height/2);i.fillStyle="white",i.font=e+"px "+o,i.fillText(t,r,s);for(var a=i.measureText(t).width,h=r,l=s-e-2,u=h+a+r,d=l+e+.5*e,f=i.getImageData(h,l,u-h,d-l),c=n.createArray(f.width,f.height),g=0,w=0,v=0;v<f.data.length;v+=4)c[g][w]=0!==f.data[v],g++,g===f.width&&(g=0,w++);var _=Number.MAX_VALUE,y=Number.MAX_VALUE,m=-Number.MAX_VALUE,p=-Number.MAX_VALUE;for(g=0;g<c.length;g++)for(w=0;w<c[g].length;w++)c[g][w]&&(_=Math.min(_,g),y=Math.min(y,w),m=Math.max(m,g),p=Math.max(p,w));var b=n.createArray(m-_,p-y);for(g=0;m-_>g;g++)for(w=0;p-y>w;w++)b[g][w]=c[_+g][y+w];this.debug&&(i.strokeStyle="yellow",i.strokeRect(h,l,u-h,d-l)),i.strokeStyle="red",i.strokeRect(r,s,this._canvas.width,this._canvas.height);var x=m-_,k=p-y,S=-(r-(h+_)),O=-(s-(l+y));this.debug&&(i.strokeStyle="green",i.strokeRect(r+S,s+O,x,k));var F={bb:{offsetX:S,offsetY:O,width:x,height:k},bitmap:b,fontSize:e,fontFamily:o};return F},fits:function(t,e){for(var n=t.x+t.bb.offsetX,o=t.y+t.bb.offsetY,i=e.length,r=e[0].length,s=0>n||0>o,a=!1,h=s||a,l=0;l<t.bb.width&&!h;l++)for(var u=n+l,d=0;d<t.bb.height&&!h;d++){var f=o+d;u>=i||f>=r?s=!0:e[u][f]&&(a=!0),h=s||a}return!h}}),e.exports=o},{"./util":5}],5:[function(t,e){var n={extend:function(t){var e,n,o;for(n=1;n<arguments.length;n++){o=arguments[n];for(e in o)o.hasOwnProperty(e)&&(t[e]=o[e])}return t},lerp:function(t,e,n){return t+n*(e-t)},step:function(t,e,n){return Math.round(this.lerp(t,e,n))},createArray:function(t){var e=new Array(t||0),n=t;if(arguments.length>1)for(var o=Array.prototype.slice.call(arguments,1);n--;)e[t-1-n]=this.createArray.apply(this,o);return e}};e.exports=n},{}]},{},[2])(2)});