!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var i;"undefined"!=typeof window?i=window:"undefined"!=typeof global?i=global:"undefined"!=typeof self&&(i=self),i.WordCloudCanvas=t()}}(function(){return function t(i,r,n){function e(o,s){if(!r[o]){if(!i[o]){var h="function"==typeof require&&require;if(!s&&h)return h(o,!0);if(a)return a(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=r[o]={exports:{}};i[o][0].call(f.exports,function(t){var r=i[o][1][t];return e(r?r:t)},f,f.exports,t,i,r,n)}return r[o].exports}for(var a="function"==typeof require&&require,o=0;o<n.length;o++)e(n[o]);return e}({1:[function(t,i){function r(t){var i=new Array(t||0),n=t;if(arguments.length>1)for(var e=Array.prototype.slice.call(arguments,1);n--;)i[t-1-n]=r.apply(this,e);return i}var n=t("./util"),e=t("./textbitmap"),a=function(t){this._canvas=null,this._words=null,this._bitmap=null,this._textBitmapper=null,n.extend(this,t)};a.prototype=n.extend(a.prototype,{_initialize:function(){this._textBitmapper=new e,this._bitmap=r(this._canvas.width,this._canvas.height);for(var t=0;t<this._canvas.width;t++)for(var i=0;i<this._canvas.height;i++)this._bitmap[t][i]=!1},canvas:function(t){return t?(this._canvas=t,this):this._canvas},words:function(t){return t?(this._words=t,this):this._words},bitmap:function(){return this._textBitmapper.toCanvas(this._bitmap)},onWordOver:function(t){return this._onWordOver=t,this},layout:function(){function t(t){var i=t.offsetX,n=t.offsetY,e=r._bitmap[i][n];e&&r._onWordOver&&r._onWordOver(e)}this._initialize();var i={};if(this._words){var r=this,e=Number.MAX_VALUE,a=0;Object.keys(this._words).forEach(function(t){e=Math.min(r._words[t],e),a=Math.max(r._words[t],a)});var o=10,s=200;Object.keys(this._words).forEach(function(t){var h=(r._words[t]-e)/(a-e),f=n.step(o,s,h),u=r._textBitmapper.create(t,f,"Calibri");i[t]=u})}var h=Object.keys(this._words).sort(function(t,i){return r._words[i]-r._words[t]});return h.forEach(function(t){for(var n=!1,e=100;!n&&e>0;){var a=Math.floor(Math.random()*r._canvas.width),o=Math.floor(Math.random()*r._canvas.height);if(i[t].x=a,i[t].y=o,r._textBitmapper.fits(i[t],r._bitmap)){n=!0;for(var s=i[t].bitmap.length,h=i[t].bitmap[0].length,f=0;s>f;f++)for(var u=0;h>u;u++){var c=i[t].x+i[t].bb.offsetX+f,l=i[t].y+i[t].bb.offsetY+u;i[t].bitmap[f][u]&&(r._bitmap[c][l]=t)}}else e--}n||(i[t].x=-1,i[t].y=-1)}),this._canvas.onmousemove=t,i}}),i.exports=a},{"./textbitmap":3,"./util":4}],2:[function(t,i,r){var n=t("./util"),e=t("./layout"),a=function(t){this._words={},this._stopWords={},this._canvas=null,this._width=null,this._height=null,this._backgroundFill=null,this._onWordOver=null,this._layout=null,n.extend(this,t)};a.prototype=n.extend(a.prototype,{canvas:function(t){return t?(this._canvas=t,this._width=t.width,this._height=t.height,this):this._canvas},width:function(t){return t?(this._canvas&&(this._canvas.width=t,this._width=t),this):this.width},height:function(t){return t?(this._canvas&&(this._canvas.height=t,this._height=t),this):this._height},text:function(t){var i=t.replace(/[\.,-\/#!$%\^&\*;:{}=\-_`~()]/g,"");i=i.replace(/\[[0-9]*\]/g,""),i=i.replace(/[\t+\[\]]/g,"");var r=i.split(" ");return this.words(r),this},stop:function(t){if(t){var i=this;return t.forEach(function(t){i._stopWords[t.trim().toLowerCase()]=!0}),this}return this._stopWords},background:function(t){return t?(this._backgroundFill=t,this):this._backgroundFill},words:function(t){if(t){var i=this;return t.forEach(function(t){var r=t.trim().toLowerCase();if(!i._stopWords[r]&&""!==r){var n=i._words[r];n||(n=0),n++,i._words[r]=n}}),this}return this._words},onWordOver:function(t){return this._onWordOver=t,this},generate:function(){var t=(new e).canvas(this._canvas).words(this._words).onWordOver(this._onWordOver),i=t.layout(),r=this._canvas.getContext("2d");return this._backgroundFill&&(r.fillStyle=this._backgroundFill,r.fillRect(0,0,this._width,this._height)),Object.keys(i).forEach(function(t){var n=i[t];-1!==n.x&&-1!==n.y&&(r.font=n.fontSize+"px "+n.fontFamily,r.fillStyle="red",r.strokeStyle="green",r.fillText(t,n.x,n.y))}),this}}),r.Extend=n.extend,r.WordCloud=a},{"./layout":1,"./util":4}],3:[function(t,i){function r(t){var i=new Array(t||0),n=t;if(arguments.length>1)for(var e=Array.prototype.slice.call(arguments,1);n--;)i[t-1-n]=r.apply(this,e);return i}var n=t("./util"),e=function(t){this._canvas=null,this._context=null,n.extend(this,t),this._canvas=document.createElement("canvas"),this._canvas.width=640,this._canvas.height=480,this._context=this._canvas.getContext("2d"),this._bitmap=r(this._canvas.width,this._canvas.height);for(var i=0;i<this._canvas.width;i++)for(var e=0;e<this._canvas.height;e++)this._bitmap[i][e]=!1};e.prototype=n.extend(e.prototype,{create:function(t,i,n){var e=this._context;e.fillStyle="black",e.fillRect(0,0,this._canvas.width,this._canvas.height);var a=5,o=Math.floor(this._canvas.height/2);e.fillStyle="white",e.font=i+"px "+n,e.fillText(t,a,o);for(var s=e.measureText(t).width,h=a,f=o-i-2,u=h+s+a,c=f+i+.5*i,l=e.getImageData(h,f,u-h,c-f),d=r(l.width,l.height),_=0,v=0,p=0;p<l.data.length;p+=4)d[_][v]=0!==l.data[p],_++,_===l.width&&(_=0,v++);var w=Number.MAX_VALUE,g=Number.MAX_VALUE,m=-Number.MAX_VALUE,b=-Number.MAX_VALUE;for(_=0;_<d.length;_++)for(v=0;v<d[_].length;v++)d[_][v]&&(w=Math.min(w,_),g=Math.min(g,v),m=Math.max(m,_),b=Math.max(b,v));var y=r(m-w,b-g);for(_=0;m-w>_;_++)for(v=0;b-g>v;v++)y[_][v]=d[w+_][g+v];e.strokeStyle="red",e.strokeRect(a,o,this._canvas.width,this._canvas.height);var x=m-w,M=b-g,W=-(a-(h+w)),k=-(o-(f+g)),A={bb:{offsetX:W,offsetY:k,width:x,height:M},bitmap:y,fontSize:i,fontFamily:n};return A},fits:function(t,i){for(var r=t.x+t.bb.offsetX,n=t.y+t.bb.offsetY,e=i.length,a=i[0].length,o=0>r||0>n,s=!1,h=o||s,f=0;f<t.bb.width&&!h;f++)for(var u=r+f,c=0;c<t.bb.height&&!h;c++){var l=n+c;u>=e||l>=a?o=!0:i[u][l]&&(s=!0),h=o||s}return!h}}),i.exports=e},{"./util":4}],4:[function(t,i){var r={extend:function(t){var i,r,n;for(r=1;r<arguments.length;r++){n=arguments[r];for(i in n)n.hasOwnProperty(i)&&(t[i]=n[i])}return t},lerp:function(t,i,r){return t+r*(i-t)},step:function(t,i,r){return Math.round(this.lerp(t,i,r))}};i.exports=r},{}]},{},[2])(2)});